# AssetMonitor 配置文件
# 所有值都可以被环境变量覆盖 (ASSET_xxx 前缀)

# ==================== 扫描基础参数 ====================
threads: 15
request_timeout: 5
smart_sleep_min: 0.2
smart_sleep_max: 0.8

# ==================== 子域名收集 ====================
subdomain:
  sources:
    - hackertarget
    - crtsh
    # - securitytrails  # 需要API KEY
    # - shodan          # 需要API KEY
  cache_hours: 12
  dns_verify: true

# ==================== 泛域名检测 ====================
wildcard:
  test_count: 3  # 测试多少个随机子域
  content_length_threshold: 500

# ==================== POC引擎 ====================
poc:
  timeout: 3
  cache_hours: 24
  max_workers: 3
  # POC 优先级 (CRITICAL > HIGH > MEDIUM > LOW)
  priority_order:
    - "Log4j2 RCE"
    - "Spring Boot 敏感信息"
    - "SQL注入"

# ==================== 反检测配置 ====================
evasion:
  enable_proxy: false
  proxy_pool: []  # 代理IP列表，多个用逗号分隔
  ua_pool_size: 100
  referers:
    - "https://www.google.com/"
    - "https://www.bing.com/"
    - ""

# ==================== OOB盲打引擎 ====================
oob:
  enabled: false
  platform: ceye  # ceye | dnslog | http-callbacks
  timeout: 15
  ceye:
    token: "YOUR_CEYE_TOKEN"
    domain: "YOUR_IDENTIFIER.ceye.io"

# ==================== 数据库 ====================
database:
  file: "secbot_memory.db"
  pool_size: 5
  timeout: 10

# ==================== 通知告警 ====================
notify:
  enabled: true
  channels:
    - console  # 内置：控制台
    # - telegram
    # - dingtalk
    # - wechat
    # - email
  dedup_hours: 1  # 相同漏洞1小时内只通知一次
  rate_limit: 10  # 每分钟最多推送10条

  # Telegram 机器人
  telegram:
    bot_token: "YOUR_BOT_TOKEN"
    chat_id: "YOUR_CHAT_ID"

  # 钉钉机器人
  dingtalk:
    webhook: "YOUR_WEBHOOK_URL"
    secret: "YOUR_SECRET"  # 可选

  # 企业微信
  wechat:
    webhook: "YOUR_WEBHOOK_URL"

  # 邮箱
  email:
    enabled: false
    host: "smtp.gmail.com"
    port: 587
    user: "your-email@gmail.com"
    password: "your-app-password"
    from: "AssetMonitor@example.com"
    to:
      - "admin@example.com"

# ==================== 输出导出 ====================
output:
  dir: "data"
  formats:
    - txt
    - json
    - csv
  html_report: true

# ==================== 日志配置 ====================
logging:
  level: INFO  # DEBUG | INFO | WARNING | ERROR
  dir: "logs"
  max_bytes: 10485760  # 10MB
  backup_count: 10

# ==================== 断点续传 ====================
checkpoint:
  enabled: true
  dir: "checkpoints"
  auto_save_interval: 300  # 5分钟保存一次

# ==================== 高级选项 ====================
dry_run: false  # 测试模式（不真实发送请求）
debug: false    # 调试模式
